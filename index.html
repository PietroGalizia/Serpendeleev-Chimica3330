<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snakeleev</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B2RXJ2MPCL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-B2RXJ2MPCL');
    </script>
    
    <style>
       /* ---- IMPOSTAZIONI GENERALI ---- */
/* Generale */
html, body {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #002F5F 30%, #013A74 100%);
    color: white;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* Loghi */
#logoCNR-container, #logoCG-container {
    position: absolute;
    top: 20px;
    cursor: pointer;
}

#logoCNR-container { left: 10px; }
#logoCG-container { right: 10px; }

#logoCNR { width: 250px; height: auto; }
#logoCG { width: 90px; height: auto; }

/* Contenitore principale */
#content {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 20px;
    width: 90%;
    max-width: 800px;
    margin-top: 50px;
}

/* Titoli */
h1 {
    font-size: 3.8rem;
    margin: 15px;
    text-shadow: 2px 2px 12px rgba(0, 0, 0, 0.6);
}

/* Schermata iniziale */
#startScreen {
    background: rgba(255, 255, 255, 0.08);
    padding: 30px;
    border-radius: 14px;
    box-shadow: 0px 6px 15px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(12px);
    width: 80%;
    max-width: 600px;
    justify-content: space-evenly; 
}

#startScreen h2 {
    margin-bottom: 5px; /* Ridotto rispetto al valore predefinito */
}

        .section {
    width: 100%;
    text-align: center;
    margin: 15px 0; /* Spazio tra le sezioni */
}

/* Contenitore per gli slider */
.slider-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 90%;
    max-width: 500px;
    text-align: center;
    margin-bottom: 20px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(150, 174, 33, 0.6);
}

/* Etichette */
.slider-label {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 5px;
}
        
/* Slider */
.speed-container, input[type="range"] {
    width: 80%;
    max-width: 500px;
    margin-bottom: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
}

.speed-label {
    font-size: 1.4rem;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Slider */
input[type="range"] {
    width: 85%;
    height: 10px;
    -webkit-appearance: none;
    appearance: none;
    background: linear-gradient(90deg, #96AE21 0%, #417F45 100%);
    border-radius: 5px;
    outline: none;
    transition: 0.3s;
}

input[type="range"]:hover {
    background: linear-gradient(90deg, #A2C627 0%, #3D773D 100%);
}
        
/* Valore della velocità */
#selectedSpeed {
    font-size: 1.2rem;
    font-weight: bold;
    margin-top: 10px;
    color: #96AE21;
}

/* Valori dinamici */
.slider-value {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #96AE21; 
}

/* Pulsanti */
/* Contenitore per i pulsanti Instructions e Play */
.button-container {
    display: flex;
    justify-content: center;
    gap: 20px;  /* Spazio tra i pulsanti */
    margin-top: 15px;
}

/* Pulsanti */
.button {
    padding: 12px 20px;
    background-color: #96AE21;
    border: 2px solid rgba(150, 174, 33, 0.6);
    border-radius: 12px;
    color: white;
    font-size: 1.3rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
    width: 150px; /* Assicura che i pulsanti abbiano la stessa dimensione */
    text-align: center;
}

.button:hover {
    background-color: #417F45;
    transform: scale(1.05);
    box-shadow: 0px 5px 10px rgba(65, 127, 69, 0.7);
}
        
/* Menu a tendina */
select {
    width: 85%;
    padding: 12px;
    border-radius: 8px;
    border: none;
    font-size: 1.2rem;
    text-align: center;
    background: white;
    color: #002F5F;
    cursor: pointer;
    transition: 0.3s;
}

select:hover {
    background: #f3f3f3;
}

/* Istruzioni */
#instructions {
    display: none;
    margin-top: 20px;
    padding: 20px;
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
    text-align: left;
}

#instructions h3 {
    text-transform: uppercase;
    font-size: 1.5rem;
    margin-bottom: 10px;
    color: #96AE21;
}

#instructions ol {
    margin-left: 20px;
    font-size: 1.1rem;
}

/* Canvas */
#gameCanvas {
    display: none;
    background-color: #002F5F;
    margin: 0 auto;
    max-width: 100%;
    max-height: 100%;
    border-radius: 8px;
    box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.4);
}

/* Punteggio */
#scoreBoard {
    display: none;
    font-size: 1.7rem;
    font-weight: bold;
    margin-top: 20px;
}

/* Citazione */
#citation {
    margin-top: 20px;
    font-size: 14px;
    text-align: center;
    color: white;
}

#citation a {
    text-decoration: none;
    color: #96AE21;
    transition: color 0.3s;
}

#citation a:hover {
    color: #e51a4b;
}


        #touchArea {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: transparent;
        }

        #gameCanvas {
            display: none;
            background-color: #002F5F;
            margin: 0px auto;
            max-width: 100%;
            max-height: 100%;
        }
        
    </style>
</head>
<body>
    <div id="logoCNR-container" onclick="window.open('https://www.issmc.cnr.it/en/', '_blank')">
        <img id="logoCNR" src="logo.png" alt="Logo CNR-ISSMC">
    </div>

    <div id="logoCG-container" onclick="window.open('https://www.changegame.cnr.it/', '_blank')">
        <img id="logoCG" src="LogoChangeGame.png" alt="Logo ChangeGame">
    </div>
    
    <div id="content">
        <h1 id="title">Snakeleev</h1>

    <!-- Schermata iniziale-->
    <div id="startScreen">

       <div class="section">
        <h2>Dieta di Snakeleev</h2>
        <select id="dietDropdown"></select>
    </div>

    <div class="section slider-container">
        <p id="selectedElementCount" class="slider-value">Elementi: 1 ≤ Z ≤ 40</p>
        <input id="elementRange" type="range" min="1" max="118" value="40" oninput="updateElementCount()">
    </div>

    <div class="section slider-container">
        <p id="selectedSpeed" class="slider-value">Velocità: 3</p>
        <input id="speedRange" type="range" min="1" max="5" value="3" oninput="updateSpeedLabel()">
    </div>

    <div class="section button-container">
        <button class="button" onclick="toggleInstructions()">Istruzioni</button>
        <button class="button" onclick="finalSelection()">Play</button>
    </div>


    <!-- Istruzioni inizialmente nascoste -->
    <div id="instructions">
        <h3>ISTRUZIONI</h3>
        <ol>
                <li>Controlla il serpente con le frecce direzionali o i tasti W, A, S e D.</li>
                <li id="eat-instruction">Mangia gli elementi della dieta.</li>
                <li>Scambia la posizione dei due elementi con la barra spaziatrice.</li>
                <li>Metti in pausa o riprendere il gioco con il tasto P.</li>
                <li>Aggiorna la pagina per iniziare una nuova partita.</li>
        </ol>
        <h3>SISTEMA DI PUNTEGGIO</h3>
        <p>
            Il tuo punteggio aumenta quando mangi un elemento che appartiene alla dieta selezionata.  
            Mangiare un elemento al di fuori della dieta non aumenta il punteggio,  
            ma viene comunque conteggiato nel totale degli elementi mangiati.
        </p>
        <p>
            Il display del punteggio mostra:
            <br><b>Punteggio / Totale Elementi Mangiati (Percentuale)</b>
        </p>
    </div>
</div>

    <!-- Canvas del gioco -->
    <div id="selectedDietText" style="display: none;"></div>
    <div id="scoreBoard" style="display: none;"></div>
    <div id="touchArea"></div>
    <canvas id="gameCanvas"></canvas>


    <!-- Game Over -->
    <div id="gameover" style="display: none;"></div>

    <!-- Citazione -->
    <div id="citation">
        <a href="https://zenodo.org/records/10643098" target="_blank">
            Pietro Galizia <i>"Snakeleev: Gamifying the Periodic Table Through the Snake Game"</i> 
            <br>J. Chem. Educ. <b>2025</b>, Vol., n., DOI: 10.1021/acs.jchemed.
        </a>
    </div>
        
<script>
    // Mappa dei livelli di velocità
    const SPEED_LEVELS = {
        1: { speed: 1, delay: 333.335682979179 },
        2: { speed: 2, delay: 222.22180439293 },
        3: { speed: 3, delay: 166.666353296221 },
        4: { speed: 4, delay: 111.11027381 },
        5: { speed: 5, delay: 83.3333325282574 }
    };

    let maxElementsToUse = 40;
    let isElementCountChanged = false;
    let isSpeedChanged = false;  
    let rangeValue = 40;

    // Funzione per aggiornare l'etichetta della velocità
    function updateSpeedLabel() {
        const speedValue = document.getElementById('speedRange').value;
        const selectedSpeed = SPEED_LEVELS[speedValue].speed; // Ottiene la velocità in px/sec

        document.getElementById('selectedSpeed').textContent = `Speed: ${selectedSpeed}`;
        window.SPEED = SPEED_LEVELS[speedValue].delay; // Imposta il ritardo in ms
        isSpeedChanged = true;
    }

    // Funzione per aggiornare il numero massimo di elementi
    function updateElementCount() {
        maxElementsToUse = parseInt(document.getElementById('elementRange').value);
    
        document.getElementById('selectedElementCount').textContent = `Elementi: 1 ≤ Z ≤ ${maxElementsToUse}`;
    
        isElementCountChanged = true; // Segnala che lo slider è stato modificato
    }




    // Mostra la schermata iniziale al caricamento della pagina
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('speedRange').addEventListener('input', updateSpeedLabel);
        document.getElementById('elementRange').addEventListener('input', updateElementCount);
        document.getElementById('selectedElementCount').textContent = `Elementi: 1 ≤ Z ≤ 40`;
        // Imposta la velocità predefinita all'avvio
        const speedSlider = document.getElementById('speedRange');
        window.SPEED = SPEED_LEVELS[speedSlider.value];

        // Aggiorna dinamicamente la velocità mentre si sposta lo slider
        speedSlider.addEventListener('input', updateSpeedLabel);

        // Popola il dropdown delle diete
        const dietDropdown = document.getElementById("dietDropdown");
        const diets = [
            "Elementi critici", "Elementi degli smartphone", "Elementi della vita",  "Elementi del DNA",
            "Elementi essenziali per l'uomo", "Elementi usati nelle terapie",
            "Elementi usati nelle diagnosi", "Radioisotopi medici", "Elementi radioattivi (serie di decadimento U-Th)", 
            "Elementi considerati sicuri (grado A-E) in un reattore nucleare a fusione",
            "Elementi in traccia potenzialmente tossici (PTE)","Elementi tossici in tracce nei funghi essiccati",
            "Elementi dedicati a scienziati", "Elementi con nome di derivazione latina",
            "Elementi con nome di derivazione greca",
            "Elementi con nomi di città, stati, o corpi celesti",
            "Elementi con nomi che non derivano nè dal latino, nè dal greco, e nemmeno da città o stati",
            "Sostanze elementari allo stato solido alle condizioni standard di temperatura e pressione",
            "Sostanze elementari allo stato liquido alle condizioni standard di temperatura e pressione",
            "Sostanze elementari allo stato gassoso alle condizioni standard di temperatura e pressione", 
            "Elementi ferromagnetici", "Metalli ultrarefrattari","Metalli", "Nonmetalli",
            "Elementi del primo gruppo (idrogeno & metalli alcalini)",
            "Elementi del secondo gruppo (metalli alcalino terrosi)", "Elementi del 15esimo gruppo (pnicogeni)",
            "Elementi del gruppo XVI (calcogeni)", "Elementi del gruppo XVII (alogeni)",
            "Elementi del 18esimo gruppo (gas nobili)", "Lantanidi", "Attinidi",
            "Metalli di transizione", "Metalli post-transizione", "Semimetalli", "Non metalli reattivi",
            "Elementi del blocco s", "Elementi del blocco p", "Elementi del blocco d", "Elementi del blocco f",
            "Elementi noti fin dai tempi antichi"
        ];

        // Aggiunge le opzioni al dropdown
        diets.forEach(diet => {
            const option = document.createElement("option");
            option.value = diet;
            option.textContent = diet;
            dietDropdown.appendChild(option);
        });

        // Mostra la schermata iniziale
        document.getElementById('title').style.display = 'block';
        document.getElementById('gameover').style.display = 'none';
        document.getElementById('startScreen').style.display = 'block';
    });

        function toggleInstructions() {
        var instructions = document.getElementById('instructions');
        var button = document.querySelector('[onclick="toggleInstructions()"]');
    
        if (instructions.style.display === "none") {
            instructions.style.display = "block";
            button.textContent = "Nascondi istruzioni";
        } else {
            instructions.style.display = "none";
            button.textContent = "Mostra istruzioni";
        }
    }

    // Funzione per avviare il gioco
    function finalSelection() {

        // Se l'utente non ha modificato lo slider, imposta il valore predefinito
           if (!isElementCountChanged) {
                updateElementCount();
            }

        if (!isSpeedChanged) {
            document.getElementById('speedRange').value = 3;
            updateSpeedLabel(); // Aggiorna l'interfaccia
        }
        
        selectedDiet = document.getElementById("dietDropdown").value;
        window.selectedDiet = selectedDiet;
        window.maxElementsToUse = maxElementsToUse;

        document.getElementById('title').style.display = 'none';
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('gameCanvas').style.display = 'block';
        document.getElementById('selectedDietText').style.display = 'block';
        document.getElementById('scoreBoard').style.display = 'block';
        document.getElementById('touchArea').style.zIndex = 10;
        
        startNewGame();
    }

    function startNewGame() {
        document.getElementById('title').style.display = 'none';
        document.getElementById('gameCanvas').style.display = 'block';
        startGame(); // Funzione definita in Snakeleev.js
    }

    function resetGameState() {
        location.reload(); // Ricarica la pagina
    }
</script>

    <script src="JED.js"></script>
</body>
</html>
